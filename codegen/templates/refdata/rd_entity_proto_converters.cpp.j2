{#
  // codegen-metadata
  // output_path: ARQLib/ARQProtobuf/src/rd_entity_proto_converters.cpp
#}
// THIS FILE IS AUTO-GENERATED BY THE CODE-GEN SCRIPT. DO NOT EDIT.
// Contains functions to convert between RefData entity structs and their Protobuf representations.

#include <ARQProtobuf/rd_entity_proto_converters.h>

namespace ARQ::Proto::RD
{

{% for entity in entities %}
// --- Converters for {{ entity.name }} ---

void toProto( const ARQ::RD::{{ entity.name }}& arqEntity, {{ entity.name }}* const protoEntity )
{
    std::string* uuidBufPtr = protoEntity->mutable_uuid()->mutable_id();
	*uuidBufPtr = arqEntity.uuid.toString();

    {% for member in entity.members %}
    {% if member.type == "datetime" %}
    protoEntity->set_{{ member.name | snake_case }}( arqEntity.{{ member.name }}.microsecondsSinceEpoch() );
    {% else %}
    protoEntity->set_{{ member.name | snake_case }}( arqEntity.{{ member.name }} );
    {% endif %}
    {% endfor %}
}

void toProto( ARQ::RD::{{ entity.name }}&& arqEntity, {{ entity.name }}* const protoEntity )
{
    std::string* uuidBufPtr = protoEntity->mutable_uuid()->mutable_id();
	*uuidBufPtr = arqEntity.uuid.toString();

    {% for member in entity.members %}
    {% if member.type == "datetime" %}
    protoEntity->set_{{ member.name | snake_case }}( arqEntity.{{ member.name }}.microsecondsSinceEpoch() );
    {% elif member.type == "string" %}
    protoEntity->set_{{ member.name | snake_case }}( std::move( arqEntity.{{ member.name }} ) );
    {% else %}
    protoEntity->set_{{ member.name | snake_case }}( arqEntity.{{ member.name }} );
    {% endif %}
    {% endfor %}
}

ARQ::RD::{{ entity.name }} fromProto( const {{ entity.name }}& protoEntity )
{
    ARQ::RD::{{ entity.name }} arqEntity;
    arqEntity.uuid = ARQ::ID::UUID::fromString( protoEntity.uuid().id() );
    {% for member in entity.members %}
    {% if member.type == "datetime" %}
    arqEntity.{{ member.name }} = Time::DateTime( Time::Microseconds( protoEntity.{{ member.name | snake_case }}() ) );
    {% else %}
    arqEntity.{{ member.name }} = protoEntity.{{ member.name | snake_case }}();
    {% endif %}
    {% endfor %}
    return arqEntity;
}

ARQ::RD::{{ entity.name }} fromProto( {{ entity.name }}&& protoEntity )
{
    ARQ::RD::{{ entity.name }} arqEntity;
    arqEntity.uuid = ARQ::ID::UUID::fromString( protoEntity.uuid().id() );
    {% for member in entity.members %}
    {% if member.type == "datetime" %}
    arqEntity.{{ member.name }} = Time::DateTime( Time::Microseconds( protoEntity.{{ member.name | snake_case }}() ) );
    {% elif member.type == "string" %}
    arqEntity.{{ member.name }} = std::move( *protoEntity.mutable_{{ member.name | snake_case }}() );
    {% else %}
    arqEntity.{{ member.name }} = protoEntity.{{ member.name | snake_case }}();
    {% endif %}
    {% endfor %}
    return arqEntity;
}

{% endfor %}
}