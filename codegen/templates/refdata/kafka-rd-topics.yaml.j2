{#
  // codegen-metadata
  // output_path: deploy/k8s/kafka-rd-topics.yaml
#}
## THIS FILE IS AUTO-GENERATED BY THE CODE-GEN SCRIPT. DO NOT EDIT.
## Contains all the refdata entity kafka topics

# ===================================
#           Update Topics           
# ===================================
# - 4 partitions
# - Retain forever
# - 3 replicas and 2 in-sync for strong durability
# ===================================

{% for entity in entities %}
{% if not loop.first %}

---

{% endif %}
apiVersion: kafka.strimzi.io/v1beta2
kind: KafkaTopic
metadata:
  name: arq-refdata-updates-{{ entity.name | lower }}
  labels:
    strimzi.io/cluster: kafka-cluster
spec:
  topicName: ARQ.RefData.Updates.{{ entity.name }}
  partitions: 4
  replicas: 3
  config:
    retention.ms: -1
    min.insync.replicas: 2
{% endfor %}

---

# ===================================
#           Command Topics
# ===================================
# - 4 partitions (co-partitioned with Update topics so must be the same)
# - Retain for 30 days
# - 2 replicas for some durability
# ===================================
{% for entity in entities %}
{% if not loop.first %}

---

{% endif %}
apiVersion: kafka.strimzi.io/v1beta2
kind: KafkaTopic
metadata:
  name: arq-refdata-commands-{{ entity.name | lower }}
  labels:
    strimzi.io/cluster: kafka-cluster
spec:
  topicName: ARQ.RefData.Commands.{{ entity.name }}
  partitions: 4
  replicas: 2
  config:
    retention.ms: 2592000000
    min.insync.replicas: 1
{% endfor %}